#An R script to Get data from the HUD USPS ZIP Code Crosswalk Files API
library(httr)

key <- "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiI2IiwianRpIjoiY2I5ZGVhNzQ0OTI1NmY1MjlkZmU0OWJlNDNmN2ZhZmViN2VkMjljYThlNzM1NmRlOGRlN2UzYTViNjhlOGE1ZTdhM2NlYjcyNjI0N2M4ODEiLCJpYXQiOjE3MDY3MTcxNjcuNDgyNTUzLCJuYmYiOjE3MDY3MTcxNjcuNDgyNjMxLCJleHAiOjIwMjIzMzYzNjcuNDc4MjAxLCJzdWIiOiI2NTI0OSIsInNjb3BlcyI6W119.HlUJbMPOSY8EFjZolu5DLFhqJ8oRGCoRBLjiStmKGzXtbEfaZzYg_kXF3oLTr3OnF9lZMIa9SPqSQ6zoXbtTWA"
url <- "https://www.huduser.gov/hudapi/public/usps"

# Note that type is set to 1 which will return values for the ZIP to Tract file and query is set to VA which will return Zip Codes in Virginia
response <- httr::GET(url, query = list(type = 8, query = "VA"), add_headers(Authorization = paste("Bearer", key)))

#check for errors
httr::http_error(response)

#access up the output
output <- httr::content(response)


output_dataframe <- as.data.frame(output)
