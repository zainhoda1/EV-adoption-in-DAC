---
title: "Exploring Research Questions"
#execute:
#  echo: false
editor: visual
author: "Zain"
format: 
  html:
    toc: true 
    code-fold: true
    code-tools: true
    toc-location: right
    self-contained: true 
---

```{r}

knitr::opts_chunk$set(
    warning = FALSE,
    message = FALSE,
    fig.path = "figs/",
    fig.width = 7.252,
    fig.height = 4,
    comment = "#>",
    fig.retina = 3
)


```

# Research Questions:

-   Question 1 --\> What are the geospatial and longitudinal trends of vehicle diffusion from the new to used market? Are PEVs diffusing similarly to ICEVs, and is that diffusion different in DACs?

-   Question 2 --\> How are PEVs depreciating in value over time compared to ICEVs, and what (if any) impact have incentive policies (such as subsidies) had on that value?

-   Question 3 --\> What are the needs and preferences of disadvantaged and lower-income communities with respect to vehicle ownership in general and specifically for PEV ownership?

-   Question 4 --\> What are the equity implications of the above questions? Are new and used PEVs equally available (both in terms of location and affordability) in DACs compared to in other communities?

-   Answer 1 --\> Analysis of the dataset from Cars.com/marketcheck will give us the answer.

-   Answer 2 --\> Analysis of the dataset from Cars.com/marketcheck will give us the answer.

-   Answer 4 --\> Analysis of the dataset from Cars.com/marketcheck will give us the answer.

-   Answer 3 --\> This will require interviews and choice based conjoint surveys.

# Questions for DAC members:

-   What is their budget range for buying a car?
-   What is the average weekly / daily commute for them?
-   Is their night parking (a) at home (b) shared parking garage (c) street parking
-   Is their day parking (a) at work (b) shared parking garage (c) street parking
-   Does either night or day space have option of PEV charging?

# Questions for Car Dealerships operating in DAC:

-   What percentage of their cars (new/used) collection are PEV vs ICEV?
-   How has been the demand for PEV vehicles in 12 months?

# Prof's Questions:

-   What is the household income distribution across households in DACs?
-   What is the car buying situation in DACs? What % buy used vs new? What is the typical budget?
-   How important is financing? Is monthly payment as important as up-front price?
-   How important is operating costs, like fuel and insurance, relative to up front price?
-   How far do people in DACs typically drive each year?
-   What is the housing situation in DACs? What % own their own home, what % live in apartments vs. single family homes, etc.

# Data Sources:

-   DOE Contract Data --\> US Department of Energy. Data is of the November 22, 2023 accounting cycle. --\> downloaded

-   Minority Serving Institution (MSI)

-   [Energy Burden Data](https://data.openei.org/submissions/573)

-   [Environmental and Demographic Indicators](https://www.epa.gov/ejscreen)

-   [US Census Tract boundaries](https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2018.html)

-   [Covid 19 deaths](https://data.cdc.gov/NCHS/Provisional-COVID-19-Death-Counts-in-the-United-St/kn79-hsxy/about_data)

# Identification of DAC by DOE:

Brief Description of DACs Methodology

DOE's working definition of disadvantage is based on cumulative burden. There are thirty-six (36) burden indicators that reflect fossil dependence, energy burden, environmental and climate hazards, and socio-economic vulnerabilities. Further information on the indicators and data sources and can be found here.

The characterization of DACs was created using data at the census tract level. There are 73,056 census tracts in the U.S., excluding U.S. territories.

To identify the census tracts that could be categorized as a DAC, we processed data in four main steps:

-   For each census tract, we calculated the percentile values for each of the 36 burden indicators.
-   We summed the percentiles across the indicators to create a score for each tract. Each indicator received equal weight. The final scores for each census tract could range from 0 to 36, where 36 would represent the greatest disadvantage.
-   Based on the score, we selected the top 20 percent of census tracts in each state. This ensured that every state was represented.
-   To ensure wealthier locations were not inadvertently included, DAC eligibility was further restricted based on income. A census tract selected in step 3 was categorized as a DAC if at least 30% of households: are at or below 200% of Federal Poverty Level and/or are considered low-income households as defined by the Department of Housing and Urban Development (HUD)
-   In sum: To be considered a DAC, a census tract must rank in the 80th percentile of the cumulative sum of the 36 burden indicators and have at least 30% of households classified as low-income.

Additionally, federally recognized tribal lands and U.S. territories, in their entirety, are categorized as DACs in accordance with OMB's Interim Guidance "common conditions" definition of community.

[Source](https://energyjustice.egs.anl.gov/)

## Updates:

The Energy Justice Mapping Tool -- Disadvantaged Communities Reporter is undergoing development to ensure alignment with the updated DOE guidance (version 1.1 updated 7/24/2023). Federal Agencies have been directed (M-23-09 (whitehouse.gov)) to transition to using the White House Climate and Economic Justice Screening Tool (CEJST) for defining disadvantaged communities.

[CEJST methodology](https://screeningtool.geoplatform.gov/en/methodology#3/33.47/-97.5)

# Exploratory view of Data

| Variable Name            | Description           | Definition                                                                                                                |           |
|--------------------------|-----------------------|---------------------------------------------------------------------------------------------------------------------------|-----------|
| ej_index_diesel          | diesel                | EJ Index for Diesel particulate matter level in air                                                                       | Direct    |
| over_30min_commute_pct   | \>30 min commute      | Percent of total population with a drive time to employment greater than or equal to 30 minutes                           | Direct    |
| no_car_pct               | No Vehicle            | Percent of total population with no vehicle(s) available                                                                  | Direct    |
| avg_energy_burden        | Energy Burden         | Annual average energy burden based on average annual housing energy costs divided by the average annual household income  | Direct    |
| grid_outages_county      | Outage Events         | Number of power outage events that occurred for all census tracts in each county from 2017-2020                           | Direct    |
| grid_outage_duration     | Outage Duration       | Average duration of power outage events (in minutes) that occurred for all census tracts in each county from 2017-2020    | Direct    |
| avg_transport_burden     | Transportation Costs  | Transportation Costs % Income for the Regional Typical Household                                                          | Direct    |
| population               | population            | Population of census tract                                                                                                | In-Direct |
| linguistic_isolation_pct | Linguistic Isolation  | Percent of households (interpreted as individuals) where no one in the household speaks English well                      | In-Direct |

```{r}

library(logitr)
library(tidyverse)
library(fastDummies)
library(here)


DOE_J40_DAC <-read_csv(here('data','DOE_J40_DAC.csv'))

df <- filter(DOE_J40_DAC, DAC_indicator == 1)

hist(x = df$over_30min_commute_pct, 
     breaks = 10,
     main = "Percent of total population with a drive time to employment >= 30 minutes",
     ylab = "count of tract",
     xlab= "fraction of population")

```

```{r}
df_outage <- filter(df, grid_outage_duration <= 100)

hist(x = df_outage$grid_outage_duration, 
                   breaks = 10,
                   main = "Average duration of power outage events (in minutes) from  2017-2020 ",
                   ylab = "count of tract",
                   xlab= "Average duration (in minutes)")

```

```{r}
hist(x = df$avg_transport_burden, 
     breaks = 20,
     main = "Transportation Costs % Income for the Regional Typical Household ",
     ylab = "count of tract",
     xlab= "% of Income")

```

```{r}
df_no_car <- filter(df, no_car_pct <= 0.2)

hist(x = df_no_car$no_car_pct, 
     breaks = 20,
     main = "Percent of total population with no vehicle(s) available ",
     ylab = "count of tract",
     xlab= "% of Population")

```

```{r}

hist(x = df$renters_pct, 
     breaks = 20,
     main = "Proportion of occupied housing units not occupied by property owners ",
     ylab = "count of tract",
     xlab= "% of Population")

```
